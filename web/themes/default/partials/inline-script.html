<script>
(function () {
  const shell = document.getElementById('app-shell');
  const existingData = window.__SMILE_DATA__ || {};
  if (shell) {
    const manifestAttr = shell.dataset.manifestBases || '';
    const manifestBases = manifestAttr
      .split(/\s+/)
      .map((value) => value.trim())
      .filter(Boolean);
    const siteConfigUrl = shell.dataset.siteConfig || existingData.siteConfig || null;
    window.__SMILE_DATA__ = {
      ...existingData,
      manifestBases: manifestBases.length ? manifestBases : existingData.manifestBases || [],
      siteConfig: siteConfigUrl,
    };
  } else {
    window.__SMILE_DATA__ = existingData;
  }
  if (shell && shell.dataset.theme) {
    document.documentElement.dataset.theme = shell.dataset.theme;
  }
  const themeToggle = document.querySelector('[data-theme-toggle]');
  if (shell && themeToggle) {
    themeToggle.addEventListener('click', () => {
      const next = shell.dataset.theme === 'dark' ? 'light' : 'dark';
      shell.dataset.theme = next;
      document.documentElement.dataset.theme = next;
      themeToggle.setAttribute('aria-pressed', String(next === 'dark'));
    });
  }
  const navToggle = document.querySelector('.nav-toggle');
  const navMenu = document.getElementById('nav-menu');
  if (navToggle && navMenu) {
    navToggle.addEventListener('click', () => {
      const isOpen = navMenu.dataset.open === 'true';
      const next = isOpen ? 'false' : 'true';
      navMenu.dataset.open = next;
      navToggle.setAttribute('aria-expanded', String(next === 'true'));
    });
  }
})();
</script>
